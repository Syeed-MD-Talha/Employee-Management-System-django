import json
import os
from django.conf import settings
from django.core.files import File
from Home.models import Employee  

# Open and load the JSON file
with open(os.path.join(settings.BASE_DIR, 'employee.json'), 'r') as file: 
    data = json.load(file)

# Loop through the data and save each employee
for item in data:
    # Define the path to the image file based on your file structure
    image_path = os.path.join(settings.BASE_DIR, item['photo'])
    
    # Check if the image exists
    if os.path.exists(image_path):
        with open(image_path, 'rb') as img_file:
            employee = Employee(
                full_name=item['full_name'],
                email=item['email'],
                mobile=item['mobile'],
                date_of_birth=item['date_of_birth'],
                photo=File(img_file, name=os.path.basename(image_path))  # Handle image upload
            )
            employee.save()  # Save the employee to the database
            print(f"Uploaded {employee.full_name}'s data and image successfully.")
    else:
        print(f"Image not found: {image_path}")
